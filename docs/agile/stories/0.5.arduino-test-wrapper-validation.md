# Story 0.5: Arduino Test Wrapper Validation

**Story ID**: S-0.5
**Epic**: Epic 0: HIL Testing Framework & Hardware Verification
**Priority**: High
**Owner**: Product Owner
**Created**: 2025-09-10
**Updated**: 2025-09-10

## Status

NotStarted

## User Story

As a firmware QA engineer,
I want the Arduino Uno R4 test wrapper and ISP programming interface validated end-to-end,
so that we can reliably program and exercise the ATmega32A DUT during HIL testing.

## Scope

- Validate Arduino Uno R4 as ISP programmer for ATmega32A
- Verify serial command protocol between test wrapper and HIL tools
- Confirm pin mapping against `config/hardware-config.yaml` (SOLE SOURCE OF TRUTH)
- Smoke-test signal drive/measure paths used by acceptance tests

## Acceptance Criteria

1. Arduino Uno R4 ISP can program ATmega32A reliably (â‰¥3 consecutive flashes) 
2. Serial protocol commands execute with expected responses within 100ms
3. All wrapper-to-DUT connections match `config/hardware-config.yaml`
4. Basic GPIO/ADC/PWM exercises pass via HIL scripts using the wrapper
5. Clear troubleshooting guide for common ISP/serial failures is documented

## Tasks

- [ ] Document ISP wiring and parameters for ATmega32A
- [ ] Add make target for ISP flash (if missing) and verify sequence
- [ ] Validate serial role toggles and bidirectional roles (wrapper/DUT) per pin matrix
- [ ] Run HIL smoke tests for GPIO/ADC/PWM through wrapper
- [ ] Capture logs/artifacts in `test/acceptance/logs/`

## Definition of Done

- [ ] ISP flashing passes 3x consecutively without error
- [ ] Serial command roundtrip verified across key commands
- [ ] Wrapper pin map validated vs `config/hardware-config.yaml`
- [ ] HIL smoke tests passing and logged
- [ ] Troubleshooting notes added to `docs/Testing/`

## Links

- Epic: `docs/agile/epics/epic-0-hil-testing-framework-hardware-verification.md`
- Pin Matrix: `config/hardware-config.yaml`
