# @file: directory-readme-tmpl.yaml
# @author: Axovia AI
# @date: 2025-09-11
# @version: 1.0
# @description: Directory README Template for standardized per-directory documentation

template:
  id: directory-readme-template-v1
  name: Directory README (Axovia AI Standard)
  version: 1.0
  output:
    format: markdown
    # !!!IMPORTANT!!!: supply output_path when generating; typically the target directory path
    filename: {{output_path}}/README.md
    title: "Directory README for {{directory_title}}"

workflow:
  mode: non-interactive
  elicitation: minimal

sections:
  - id: frontmatter
  # This section renders a YAML-style frontmatter header block
    title: Frontmatter
    content: |
      ---
      # <!-- Generated by ~* Axovia Flow™ Agentic Framework -->
      file: {{relative_file_path}}
      title: {{directory_title}}
      author: {{author}}
      company: Axovia AI
      date: {{date}}
      brief: {{brief}}
      version: {{version}}
      dependencies:
      {{#each dependencies}}
        - file: {{file}}
          type: {{type}}
          required: {{required}}
          description: {{description}}
      {{/each}}
      commands:
      {{#each commands}}
        - {{#if this.task_name}}{{this.task_name}}:{{/if}}
          {{#if this.type}}type: {{this.type}}{{/if}}
          {{#if this.flowFile}}flowFile: {{this.flowFile}}{{/if}}
          {{#if this.description}}description: {{this.description}}{{/if}}
          {{#if this.options}}options:
          {{#each this.options}}
            - {{this}}
          {{/each}}
          {{/if}}
      tags:
      {{#each tags}}
        - {{this}}
      {{/each}}
      ---

  - id: provenance
    title: Provenance
    content: |
      <!-- Generated by Axovia Flow™ Agentic Framework  -->

  - id: critical-rules
    title: Critical Rules (Optional)
    template: |
      {{#if critical_block_title}}
      > <--------------------------------------------------------------->
      > ***!!! CRITICAL AGENT RULES FOR {{critical_block_title}} !!!***
      > <--------------------------------------------------------------->
      {{/if}}
      {{#each critical_rules}}
      - {{this}}
      {{/each}}

  - id: overview
    title: Overview
    template: |
      {{#each overview_points}}
      - {{this}}
      {{/each}}

  - id: directory-structure
    title: Directory Structure
    content: |
      ```text
      {{directory_tree}}
      ```

  - id: commands
    title: Commands and Targets
    template: |
      ```yml
      targets:
      {{#each targets}}
        - `{{this.command}}`
          description: {{this.description}}
          {{#if this.options}}options:
          {{#each this.options}}
            - {{this}}
          {{/each}}
          {{/if}}
      {{/each}}
      ```

  - id: links
    title: Links and Traceability
    template: |
      {{#each links}}
      - {{this}}
      {{/each}}

# Template Variables
variables:
  output_path:
    type: text
    description: "Absolute or relative path to the target directory that will receive README.md"
    required: true

  relative_file_path:
    type: text
    description: "Path displayed in the header for 'file:' entry (e.g., tests/acceptance/README.md)"
    required: true

  directory_title:
    type: text
    description: "Human-friendly directory title (e.g., Acceptance Tests for Axovia Flow)"
    required: true

  author:
    type: text
    description: "Maintainer or author"
    required: true

  date:
    type: date
    description: "YYYY-MM-DD"
    required: true

  brief:
    type: text
    description: "1-2 sentence overview of the directory purpose"
    required: true

  version:
    type: text
    description: "Semantic or simple version"
    default: "1.0"

  dependencies:
    type: list(object)
    description: "List of dependency objects each with file, type, required, description"
    default: []

  commands:
    type: list(object)
    description: "List of command/task objects for frontmatter commands section"
    default: []

  tags:
    type: list(text)
    description: "Tags for AI indexing"
    default: []

  critical_block_title:
    type: text
    description: "Title to display in emphasized critical block"
    required: false

  critical_rules:
    type: list(text)
    description: "Bullet list for emphasized rules"
    default: []

  overview_points:
    type: list(text)
    description: "Bulleted overview lines"
    default: []

  directory_tree:
    type: text
    description: "Pre-rendered directory tree content"
    required: true

  targets:
    type: list(object)
    description: "Targets for 'Commands and Targets' section"
    default: []

  links:
    type: list(text)
    description: "Reference links for traceability"
    default: []
