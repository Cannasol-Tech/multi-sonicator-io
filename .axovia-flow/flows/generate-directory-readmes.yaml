# @file: generate-directory-readmes.yaml
# @author: Axovia AI
# @date: 2025-09-11
# @version: 1.0
# @description: Flow to generate standardized README.md files for directories

flow:
  id: generate-directory-readmes-v1
  name: Generate Directory READMEs
  description: Create/refresh README.md files in selected directories using the standard template

inputs:
  directories:
    type: list(text)
    description: "Directories to generate README.md for"
    required: true
  author:
    type: text
    description: "Maintainer or author name"
    required: true
  date:
    type: date
    description: "Date to embed in frontmatter"
    required: true
  version:
    type: text
    description: "README format version"
    default: "1.0"
  tags:
    type: list(text)
    description: "Tags for AI indexing"
    default: []

steps:
  - id: gather-structure
    name: Gather Directory Structure
    description: Render a shallow tree for each target directory (depth configurable in future)
    outputs:
      directory_trees: map(text)
    implementation: |
      # PSEUDO: For each dir in inputs.directories, compute a 2-level tree
      # directory_trees[dir] = tree -L 2 (or internal traversal)

  - id: render-readmes
    name: Render READMEs
    description: Render README.md using the directory_readme template
    depends_on: [gather-structure]
    implementation: |
      # PSEUDO: For each dir in inputs.directories
      # 1) Build variables
      #    output_path = dir
      #    relative_file_path = <relpath>/README.md
      #    directory_title = Basename(dir)
      #    author = inputs.author
      #    date = inputs.date
      #    brief = "Overview and usage for the {{directory_title}} directory."
      #    version = inputs.version
      #    dependencies = [] (can be extended per-dir)
      #    commands = [] (can be extended per-dir)
      #    tags = inputs.tags
      #    critical_block_title = null (unless provided)
      #    critical_rules = [] (unless provided)
      #    overview_points = [] (unless provided)
      #    directory_tree = steps.gather-structure.outputs.directory_trees[dir]
      #    targets = []
      #    links = []
      # 2) Render template: templates.directory_readme
      # 3) Write to: <dir>/README.md (create if missing, replace if present)
    template: directory_readme
